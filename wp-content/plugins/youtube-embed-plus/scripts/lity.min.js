
/*! Lity - v1.6.6 - 2016-04-22
* http://sorgalla.com/lity/
* Copyright (c) 2016 Jan Sorgalla; Licensed MIT */
(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return a(b,c)})}else{if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a(b,require("jquery"))}else{b.lity=a(b,b.jQuery||b.Zepto)}}}(typeof window!=="undefined"?window:this,function(j,g){var n=j.document;var i=g(j);var d=g("html");var s=0;var e=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i;var w=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i;var l=/(vimeo(pro)?.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/;var v=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i;var u={image:r,inline:p,iframe:f};var k={esc:true,handler:null,template:'<div class="lity" tabindex="-1"><div class="lity-wrap" data-lity-close><div class="lity-loader">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" title="Close (Esc)" data-lity-close>Ã—</button></div></div></div>'};function c(){d[s>0?"addClass":"removeClass"]("lity-active")}var a=(function(){var z=n.createElement("div");var y={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var x in y){if(z.style[x]!==undefined){return y[x]}}return false})();function h(y){var x=g.Deferred();if(!a){x.resolve()}else{y.one(a,x.resolve);setTimeout(x.resolve,500)}return x.promise()}function t(y,x,z){if(arguments.length===1){return g.extend({},y)}if(typeof x==="string"){if(typeof z==="undefined"){return typeof y[x]==="undefined"?null:y[x]}y[x]=z}else{g.extend(y,x)}return this}function m(B){var y=decodeURI(B).split("&");var A={},z;for(var x=0,C=y.length;x<C;x++){if(!y[x]){continue}z=y[x].split("=");A[z[0]]=z[1]}return A}function o(x,y){return x+(x.indexOf("?")>-1?"&":"?")+g.param(y)}function q(x){return g('<span class="lity-error"/>').append(x)}function r(A){if(!e.test(A)){return false}var z=g('<img src="'+A+'">');var y=g.Deferred();var x=function(){y.reject(q("Failed loading image"))};z.on("load",function(){if(this.naturalWidth===0){return x()}y.resolve(z)}).on("error",x);return y.promise()}function p(z){var x;try{x=g(z)}catch(y){return false}if(!x.length){return false}var A=g('<span style="display:none !important" class="lity-inline-placeholder"/>');return x.after(A).on("lity:ready",function(C,B){B.one("lity:remove",function(){A.before(x.addClass("lity-hide")).remove()})})}function f(z){var y,x=z;y=w.exec(z);if(y){x=o("https://www.youtube"+(y[2]||"")+".com/embed/"+y[4],g.extend({autoplay:1},m(y[5]||"")))}y=l.exec(z);if(y){x=o("https://player.vimeo.com/video/"+y[3],g.extend({autoplay:1},m(y[4]||"")))}y=v.exec(z);if(y){x=o("https://www.google."+y[3]+"/maps?"+y[6],{output:y[6].indexOf("layer=c")>0?"svembed":"embed"})}return'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+x+'"></iframe></div>'}function b(J){var E={},A={},H,C,I=g.Deferred().resolve();function y(K){if(K.keyCode===27){F()}}function z(){var K=n.documentElement.clientHeight?n.documentElement.clientHeight:Math.round(i.height());C.css("max-height",Math.floor(K)+"px").trigger("lity:resize",[H])}function D(K,L){if(!H){return}C=g(L);i.on("resize",z);z();H.find(".lity-loader").each(function(){var M=g(this);h(M).always(function(){M.remove()})});H.removeClass("lity-loading").find(".lity-content").empty().append(C);C.removeClass("lity-hide").trigger("lity:ready",[H,K]);I.resolve()}function G(M,N,K,L){I=g.Deferred();s++;c();H=g(K.template).addClass("lity-loading").appendTo("body");if(!!K.esc){i.on("keyup",y)}setTimeout(function(){H.addClass("lity-opened lity-"+M).on("click","[data-lity-close]",function(O){if(g(O.target).is("[data-lity-close]")){F()}}).trigger("lity:open",[H,L]);g.when(N).always(g.proxy(D,null,L))},0)}function B(R,M,P){var O,Q,K=g.extend({},u,A);M=g.extend({},k,E,M);if(M.handler&&K[M.handler]){Q=K[M.handler](R,x);O=M.handler}else{var L={};g.each(["inline","iframe"],function(T,S){if(K[S]){L[S]=K[S]}delete K[S]});var N=function(S,T){if(!T){return true}Q=T(R,x);if(!!Q){O=S;return false}};g.each(K,N);if(!O){g.each(L,N)}}if(Q){g.when(F()).done(g.proxy(G,null,O,Q,M,P))}return !!Q}function F(){if(!H){return}var K=g.Deferred();I.done(function(){s--;c();i.off("resize",z).off("keyup",y);C.trigger("lity:close",[H]);H.removeClass("lity-opened").addClass("lity-closed");var L=H,M=C;H=null;C=null;h(M.add(L)).always(function(){M.trigger("lity:remove",[L]);L.remove();K.resolve()})});return K.promise()}function x(M){if(!M.preventDefault){return x.open(M)}var L=g(this);var N=L.data("lity-target")||L.attr("href")||L.attr("src");if(!N){return}var K=L.data("lity-options")||L.data("lity");if(B(N,K,L)){L.blur();M.preventDefault()}}x.handlers=g.proxy(t,x,A);x.options=g.proxy(t,x,E);x.open=function(M,K,L){B(M,K,L);return x};x.close=function(){F();return x};return x.options(J)}b.version="1.6.6";b.handlers=g.proxy(t,b,u);b.options=g.proxy(t,b,k);g(n).on("click","[data-lity]",b());return b}));